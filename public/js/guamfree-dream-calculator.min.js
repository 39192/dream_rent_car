const compactChargeSet = {basic: 39, zdc: 10}, // 컴팩트 5인
  midSize2ChargeSet = {basic: 57, zdc: 10}, // 미드사이즈
  fullSizeChargeSet = {basic: 67, zdc: 15}, // 풀사이즈 5인
  suvChargeSet = {basic: 67, zdc: 15}, //Ssuv 5인
  convertibleChargeSet = {basic: 120, zdc: 30}, //컨버터블
  sevenVanChargeSet = {basic: 99, zdc: 30}, // 7,8인승 밴
  eightVanChargeSet = {basic: 99, zdc: 30}, chargeSet = {
    compact: compactChargeSet,
    midSize2: midSize2ChargeSet,
    fullSize: fullSizeChargeSet,
    suv: suvChargeSet,
    convertible: convertibleChargeSet,
    sevenVan: sevenVanChargeSet,
    eightVan: eightVanChargeSet
  };

function addDays(e, t) {
  return new Date(e.getTime() + 864e5 * t)
}

function refreshFromChangeTime() {
  if (1 > getRentDays()) {
    alert("렌트 기간은 1일부터 가능합니다.");
    var e = addDays(new Date($("#pickup-date").val()), 1);
    $(".input-group.date.return-date").datepicker("setDate", e), $(
      "#return-time").val($("#pickup-time").val())
  }
  refresh()
}

function initializeDatePicker() {
  $(".input-group.date.pickup-date").datepicker({
    calendarWeeks: !1,
    todayHighlight: !0,
    keyboardNavigation: !1,
    autoclose: !0,
    format: "yyyy-mm-dd",
    language: "kr",
    startDate: new Date(addDays(new Date, 0))
  }), $(".input-group.date.return-date").datepicker({
    calendarWeeks: !1,
    todayHighlight: !0,
    keyboardNavigation: !1,
    autoclose: !0,
    format: "yyyy-mm-dd",
    language: "kr",
    startDate: new Date(addDays(new Date, 1))
  }), $(".input-group.date.pickup-date").datepicker("setDate",
    addDays(new Date, 0)), $(".input-group.date.return-date").datepicker(
    "setDate", addDays(new Date, 1))
}

function initializeTimeComboBox() {
  for (let e = 8; e <= 18; e++) {
    let t = 10 == e ? "selected" : "", a = (e < 10 ? "0" : "") + e + ":00";
    if ($("#pickup-time").append(
      "<option value=" + a + " " + t + ">" + a + "</option>"), e < 24) {
      let r = (e < 10 ? "0" : "") + e + ":30";
      $("#pickup-time").append("<option value=" + r + ">" + r + "</option>")
    }
  }
  for (let i = 0; i <= 2; i++) {
    let n = (i < 10 ? "0" : "") + i + ":00";
    if ($("#return-time").append(
      "<option value=" + n + ">" + n + "</option>"), i < 24) {
      let o = (i < 10 ? "0" : "") + i + ":30";
      $("#return-time").append("<option value=" + o + ">" + o + "</option>")
    }
  }
  for (let c = 8; c <= 23; c++) {
    let u = 10 == c ? "selected" : "", l = (c < 10 ? "0" : "") + c + ":00";
    if ($("#return-time").append(
      "<option value=" + l + " " + u + ">" + l + "</option>"), c < 24) {
      let d = (c < 10 ? "0" : "") + c + ":30";
      $("#return-time").append("<option value=" + d + ">" + d + "</option>")
    }
  }
}

function refresh() {
  setRentDays(), processAboutAllChargesOf("compact"), processAboutAllChargesOf(
    "midSize2"), processAboutAllChargesOf("fullSize"), processAboutAllChargesOf(
    "suv"), processAboutAllChargesOf("convertible"), processAboutAllChargesOf(
    "sevenVan"), processAboutAllChargesOf("eightVan")
}

function setRentDays() {
  let e = getAdditionalHour(), t = Math.floor(e), a = (e - Math.floor(e)) * 60;
  $("#rentDays").html(
    getRentDays() + " 일" + (e > 0 && e < 7 ? " + " + (t > 0 ? t + " 시간 " : "")
      + (a > 0 ? a + " 분" : "") : ""))
}

function processAboutAllChargesOf(e) {
  let t = getReservationCharge(), // 예약 요금을 계산합니다.
    a = getBasicCharge(e), // 선택된 차량 유형에 대한 기본 요금을 계산합니다.
    r = a + getZDCCharge(e); // 기본 요금에 ZDC 요금을 더해 총 요금을 계산합니다.
  let totalHours = getRentDays() * 24 + getAdditionalHour(),
    discountAmount = 0,
    isDiscountApplied = !1;
  if (totalHours >= 72) {
    discountAmount = 20;
    isDiscountApplied = !0;
  }
  let discountedA = a - discountAmount;
  let discountedR = r - discountAmount;
  $("#" + e + "-basic-below-three-days").text(convertDollarText(discountedA)), $(
    "#" + e + "-basic-reservation").text(convertDollarText(t)), $(
    "#" + e + "-basic-office").text(convertDollarText(discountedA - t)), $(
    "#" + e + "-zdc-below-three-days").text(convertDollarText(discountedR)), $(
    "#" + e + "-zdc-reservation").text(convertDollarText(t)), $(
    "#" + e + "-zdc-office").text(convertDollarText(discountedR - t)),
    isDiscountApplied ? $("#" + e + "-discount-message").text("※ 72시간 이상, 동일차량렌트 프로모션 ($-20) 적용된 금액입니다.").show() : $("#" + e + "-discount-message").hide()
}

function getBasicCharge(e) {
  let t = chargeSet[e].basic;
  return t * getRentDays() + getAdditionalTimeCharge(t)
}

function getRentDays() {
  return getDiffPickupDateAndReturnDate() + getAdditionalDayCharge()
}

function getDiffPickupDateAndReturnDate() {
  let e = new Date($("#pickup-date").val()), t;
  return (new Date($("#return-date").val()) - e) / 864e5
}

function getReservationCharge() {
  return 10 * getRentDays() // 대여 일수에 대해 10달러를 곱한 값이 예약 요금으로 계산됩니다.
}

function getZDCCharge(e) {
  let t = getDiffPickupDateAndReturnDate() + getAdditionalDayZDCCharge();
  return chargeSet[e].zdc * t
}

function getAdditionalDayZDCCharge() {
  let e = getAdditionalHour();
  return e >= 3 && e < 24 ? 1 : 0 // 추가 시간이 3시간 이상이고 24시간 미만인 경우, 1일(1)로 계산하고, 그렇지 않으면 추가 요금이 없음을 나타내기 위해 0을 반환
}

function getAdditionalTimeCharge(e) {
  let t = getAdditionalHour(); // 추가 시간(시간 단위)을 계산합니다.
  return t > 0 && t < 6 ? t / .5 * 5 : // 추가 시간이 0시간 초과이고 6시간 미만인 경우, 30분마다 5달러의 요금이 부과됩니다.
    t >= 6 && t < 7 ? e - (6 == t ? 10 : 5) : // 추가 시간이 6시간 이상이고 7시간 미만인 경우, 6시간일 때는 기본 요금에서 10달러를 빼고, 그 외는 5달러를 뺍니다.
      0 // 그 외의 경우 추가 요금이 없습니다.
}

function getAdditionalDayCharge() {
  let e = getAdditionalHour();
  return e >= 7 && e < 24 ? 1 : 0
}

function getAdditionalHour() {
  let e = Number($("#return-time").val().split(":")[0]) - Number(
      $("#pickup-time").val().split(":")[0]),
    t = Number($("#return-time").val().split(":")[1]) - Number(
      $("#pickup-time").val().split(":")[1]);
  return (e > 0 ? e : 0) + (e >= 0 && t > 0 ? t / 60 : 0)
}

function convertDollarText(e) {
  return "$" + Number(e).toFixed(1)
}

$(document).ready(function () {
  initializeDatePicker(), initializeTimeComboBox(), $(
    ".input-group.date.pickup-date").on("change", function () {
    gtag("event", "change_pickup_date",
      {event_category: "guamfree_calculator"});
    var e = addDays(new Date($("#pickup-date").val()), 1);
    $(".input-group.date.return-date").datepicker("setDate", e), $(
      "#return-time").val($("#pickup-time").val()), refresh()
  }), $(".input-group.date.return-date").on("change", function () {
    if (gtag("event", "change_return_date",
      {event_category: "guamfree_calculator"}), 0
    >= getDiffPickupDateAndReturnDate()) {
      alert("렌트 기간은 1일부터 가능합니다.");
      var e = addDays(new Date($("#pickup-date").val()), 1);
      $(".input-group.date.return-date").datepicker("setDate", e), $(
        "#return-time").val($("#pickup-time").val())
    }
    refresh()
  }), $("#pickup-time").change(function () {
    gtag("event", "change_pickup_time",
      {event_category: "guamfree_calculator"}), refreshFromChangeTime()
  }), $("#return-time").change(function () {
    gtag("event", "change_return_time",
      {event_category: "guamfree_calculator"}), refreshFromChangeTime()
  }), refresh()
});
